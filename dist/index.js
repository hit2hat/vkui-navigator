!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("prop-types"),require("@vkontakte/vk-bridge"),require("@vkontakte/vkui")):"function"==typeof define&&define.amd?define(["react","prop-types","@vkontakte/vk-bridge","@vkontakte/vkui"],e):(t=t||self).app=e(t.React,t.PropTypes,t.VKBridge,t.vkui)}(this,(function(t,e,o,n){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function a(t,e){return t(e={exports:{}},e.exports),e.exports}var s=a((function(t,e){t.exports=function(){var t=function(t){var e=t.id,o=t.viewBox,n=t.content;this.id=e,this.viewBox=o,this.content=n};function e(t,e){return t(e={exports:{}},e.exports),e.exports}t.prototype.stringify=function(){return this.content},t.prototype.toString=function(){return this.stringify()},t.prototype.destroy=function(){var t=this;["id","viewBox","content"].forEach((function(e){return delete t[e]}))},"undefined"!=typeof window?window:void 0!==r||"undefined"!=typeof self&&self;var o=e((function(t,e){t.exports=function(){function t(t){return t&&"object"==typeof t&&"[object RegExp]"!==Object.prototype.toString.call(t)&&"[object Date]"!==Object.prototype.toString.call(t)}function e(e,o){var r;return o&&!0===o.clone&&t(e)?n((r=e,Array.isArray(r)?[]:{}),e,o):e}function o(o,r,i){var a=o.slice();return r.forEach((function(r,s){void 0===a[s]?a[s]=e(r,i):t(r)?a[s]=n(o[s],r,i):-1===o.indexOf(r)&&a.push(e(r,i))})),a}function n(r,i,a){var s=Array.isArray(i),l=(a||{arrayMerge:o}).arrayMerge||o;return s?Array.isArray(r)?l(r,i,a):e(i,a):function(o,r,i){var a={};return t(o)&&Object.keys(o).forEach((function(t){a[t]=e(o[t],i)})),Object.keys(r).forEach((function(s){t(r[s])&&o[s]?a[s]=n(o[s],r[s],i):a[s]=e(r[s],i)})),a}(r,i,a)}return n.all=function(t,e){if(!Array.isArray(t)||t.length<2)throw new Error("first argument should be an array with at least two elements");return t.reduce((function(t,o){return n(t,o,e)}))},n}()})),n=e((function(t,e){e.default={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}},t.exports=e.default})),i=n.svg,a=n.xlink,s={};s[i.name]=i.uri,s[a.name]=a.uri;var l=function(t,e){return void 0===t&&(t=""),"<svg "+function(t){return Object.keys(t).map((function(e){return e+'="'+t[e].toString().replace(/"/g,"&quot;")+'"'})).join(" ")}(o(s,e||{}))+">"+t+"</svg>"};return function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var o={isMounted:{}};return o.isMounted.get=function(){return!!this.node},e.createFromExistingNode=function(t){return new e({id:t.getAttribute("id"),viewBox:t.getAttribute("viewBox"),content:t.outerHTML})},e.prototype.destroy=function(){this.isMounted&&this.unmount(),t.prototype.destroy.call(this)},e.prototype.mount=function(t){if(this.isMounted)return this.node;var e="string"==typeof t?document.querySelector(t):t,o=this.render();return this.node=o,e.appendChild(o),o},e.prototype.render=function(){var t=this.stringify();return function(t){var e=!!document.importNode,o=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement;return e?document.importNode(o,!0):o}(l(t)).childNodes[0]},e.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(e.prototype,o),e}(t)}()}));function l(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var o=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i=Object.keys(Object(r)),a=0,s=i.length;a<s;a++){var l=i[a],u=Object.getOwnPropertyDescriptor(r,l);void 0!==u&&u.enumerable&&(o[l]=r[l])}}return o}var u=l,d=a((function(t,e){t.exports=function(){function t(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof window?window:void 0!==r||"undefined"!=typeof self&&self;var e=t((function(t,e){t.exports=function(){function t(t){return t&&"object"==typeof t&&"[object RegExp]"!==Object.prototype.toString.call(t)&&"[object Date]"!==Object.prototype.toString.call(t)}function e(e,o){var r;return o&&!0===o.clone&&t(e)?n((r=e,Array.isArray(r)?[]:{}),e,o):e}function o(o,r,i){var a=o.slice();return r.forEach((function(r,s){void 0===a[s]?a[s]=e(r,i):t(r)?a[s]=n(o[s],r,i):-1===o.indexOf(r)&&a.push(e(r,i))})),a}function n(r,i,a){var s=Array.isArray(i),l=(a||{arrayMerge:o}).arrayMerge||o;return s?Array.isArray(r)?l(r,i,a):e(i,a):function(o,r,i){var a={};return t(o)&&Object.keys(o).forEach((function(t){a[t]=e(o[t],i)})),Object.keys(r).forEach((function(s){t(r[s])&&o[s]?a[s]=n(o[s],r[s],i):a[s]=e(r[s],i)})),a}(r,i,a)}return n.all=function(t,e){if(!Array.isArray(t)||t.length<2)throw new Error("first argument should be an array with at least two elements");return t.reduce((function(t,o){return n(t,o,e)}))},n}()})),o=t((function(t,e){e.default={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}},t.exports=e.default})),n=o.svg,i=o.xlink,a={};a[n.name]=n.uri,a[i.name]=i.uri;var s,l=function(t,o){return void 0===t&&(t=""),"<svg "+function(t){return Object.keys(t).map((function(e){return e+'="'+t[e].toString().replace(/"/g,"&quot;")+'"'})).join(" ")}(e(a,o||{}))+">"+t+"</svg>"},u=o.svg,d=o.xlink,c={attrs:(s={style:["position: absolute","width: 0","height: 0"].join("; ")},s[u.name]=u.uri,s[d.name]=d.uri,s)},h=function(t){this.config=e(c,t||{}),this.symbols=[]};h.prototype.add=function(t){var e=this.symbols,o=this.find(t.id);return o?(e[e.indexOf(o)]=t,!1):(e.push(t),!0)},h.prototype.remove=function(t){var e=this.symbols,o=this.find(t);return!!o&&(e.splice(e.indexOf(o),1),o.destroy(),!0)},h.prototype.find=function(t){return this.symbols.filter((function(e){return e.id===t}))[0]||null},h.prototype.has=function(t){return null!==this.find(t)},h.prototype.stringify=function(){var t=this.config.attrs,e=this.symbols.map((function(t){return t.stringify()})).join("");return l(e,t)},h.prototype.toString=function(){return this.stringify()},h.prototype.destroy=function(){this.symbols.forEach((function(t){return t.destroy()}))};var p=function(t){var e=t.id,o=t.viewBox,n=t.content;this.id=e,this.viewBox=o,this.content=n};p.prototype.stringify=function(){return this.content},p.prototype.toString=function(){return this.stringify()},p.prototype.destroy=function(){var t=this;["id","viewBox","content"].forEach((function(e){return delete t[e]}))};var f=function(t){var e=!!document.importNode,o=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement;return e?document.importNode(o,!0):o},y=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var o={isMounted:{}};return o.isMounted.get=function(){return!!this.node},e.createFromExistingNode=function(t){return new e({id:t.getAttribute("id"),viewBox:t.getAttribute("viewBox"),content:t.outerHTML})},e.prototype.destroy=function(){this.isMounted&&this.unmount(),t.prototype.destroy.call(this)},e.prototype.mount=function(t){if(this.isMounted)return this.node;var e="string"==typeof t?document.querySelector(t):t,o=this.render();return this.node=o,e.appendChild(o),o},e.prototype.render=function(){var t=this.stringify();return f(l(t)).childNodes[0]},e.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(e.prototype,o),e}(p),g={autoConfigure:!0,mountTo:"body",syncUrlsWithBaseTag:!1,listenLocationChangeEvent:!0,locationChangeEvent:"locationChange",locationChangeAngularEmitter:!1,usagesToUpdate:"use[*|href]",moveGradientsOutsideSymbol:!1},v=function(t){return Array.prototype.slice.call(t,0)},m=function(){return/firefox/i.test(navigator.userAgent)},w=function(){return/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)},b=function(){return/edge/i.test(navigator.userAgent)},P=function(t){return(t||window.location.href).split("#")[0]},O=function(t){angular.module("ng").run(["$rootScope",function(e){e.$on("$locationChangeSuccess",(function(e,o,n){var r,i,a;r=t,i={oldUrl:n,newUrl:o},(a=document.createEvent("CustomEvent")).initCustomEvent(r,!1,!1,i),window.dispatchEvent(a)}))}])},E=function(t,e){return void 0===e&&(e="linearGradient, radialGradient, pattern"),v(t.querySelectorAll("symbol")).forEach((function(t){v(t.querySelectorAll(e)).forEach((function(e){t.parentNode.insertBefore(e,t)}))})),t},x=o.xlink.uri,M=/[{}|\\\^\[\]`"<>]/g;function S(t){return t.replace(M,(function(t){return"%"+t[0].charCodeAt(0).toString(16).toUpperCase()}))}var k=["clipPath","colorProfile","src","cursor","fill","filter","marker","markerStart","markerMid","markerEnd","mask","stroke","style"],_=k.map((function(t){return"["+t+"]"})).join(","),j=function(t,e,o,n){var r=S(o),i=S(n);(function(t,e){return v(t).reduce((function(t,o){if(!o.attributes)return t;var n=v(o.attributes),r=e?n.filter(e):n;return t.concat(r)}),[])})(t.querySelectorAll(_),(function(t){var e=t.localName,o=t.value;return-1!==k.indexOf(e)&&-1!==o.indexOf("url("+r)})).forEach((function(t){return t.value=t.value.replace(new RegExp(r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),i)})),function(t,e,o){v(t).forEach((function(t){var n=t.getAttribute("xlink:href");if(n&&0===n.indexOf(e)){var r=n.replace(e,o);t.setAttributeNS(x,"xlink:href",r)}}))}(e,r,i)},A="mount",C="symbol_mount";return function(t){function o(o){var n=this;void 0===o&&(o={}),t.call(this,e(g,o));var r,i=(r=r||Object.create(null),{on:function(t,e){(r[t]||(r[t]=[])).push(e)},off:function(t,e){r[t]&&r[t].splice(r[t].indexOf(e)>>>0,1)},emit:function(t,e){(r[t]||[]).map((function(t){t(e)})),(r["*"]||[]).map((function(o){o(t,e)}))}});this._emitter=i,this.node=null;var a=this.config;if(a.autoConfigure&&this._autoConfigure(o),a.syncUrlsWithBaseTag){var s=document.getElementsByTagName("base")[0].getAttribute("href");i.on(A,(function(){return n.updateUrls("#",s)}))}var l=this._handleLocationChange.bind(this);this._handleLocationChange=l,a.listenLocationChangeEvent&&window.addEventListener(a.locationChangeEvent,l),a.locationChangeAngularEmitter&&O(a.locationChangeEvent),i.on(A,(function(t){a.moveGradientsOutsideSymbol&&E(t)})),i.on(C,(function(t){var e;a.moveGradientsOutsideSymbol&&E(t.parentNode),(w()||b())&&(e=[],v(t.querySelectorAll("style")).forEach((function(t){t.textContent+="",e.push(t)})))}))}t&&(o.__proto__=t),o.prototype=Object.create(t&&t.prototype),o.prototype.constructor=o;var n={isMounted:{}};return n.isMounted.get=function(){return!!this.node},o.prototype._autoConfigure=function(t){var e=this.config;void 0===t.syncUrlsWithBaseTag&&(e.syncUrlsWithBaseTag=void 0!==document.getElementsByTagName("base")[0]),void 0===t.locationChangeAngularEmitter&&(e.locationChangeAngularEmitter="angular"in window),void 0===t.moveGradientsOutsideSymbol&&(e.moveGradientsOutsideSymbol=m())},o.prototype._handleLocationChange=function(t){var e=t.detail,o=e.oldUrl,n=e.newUrl;this.updateUrls(o,n)},o.prototype.add=function(e){var o=t.prototype.add.call(this,e);return this.isMounted&&o&&(e.mount(this.node),this._emitter.emit(C,e.node)),o},o.prototype.attach=function(t){var e=this,o=this;if(o.isMounted)return o.node;var n="string"==typeof t?document.querySelector(t):t;return o.node=n,this.symbols.forEach((function(t){t.mount(o.node),e._emitter.emit(C,t.node)})),v(n.querySelectorAll("symbol")).forEach((function(t){var e=y.createFromExistingNode(t);e.node=t,o.add(e)})),this._emitter.emit(A,n),n},o.prototype.destroy=function(){var t=this.config,e=this.symbols,o=this._emitter;e.forEach((function(t){return t.destroy()})),o.off("*"),window.removeEventListener(t.locationChangeEvent,this._handleLocationChange),this.isMounted&&this.unmount()},o.prototype.mount=function(t,e){if(void 0===t&&(t=this.config.mountTo),void 0===e&&(e=!1),this.isMounted)return this.node;var o="string"==typeof t?document.querySelector(t):t,n=this.render();return this.node=n,e&&o.childNodes[0]?o.insertBefore(n,o.childNodes[0]):o.appendChild(n),this._emitter.emit(A,n),n},o.prototype.render=function(){return f(this.stringify())},o.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},o.prototype.updateUrls=function(t,e){if(!this.isMounted)return!1;var o=document.querySelectorAll(this.config.usagesToUpdate);return j(this.node,o,P(t)+"#",P(e)+"#"),!0},Object.defineProperties(o.prototype,n),o}(h)}()})),c=a((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,n,r=(o=d)&&o.__esModule?o:{default:o};!("undefined"==typeof window||!window.document||!window.document.createElement)?(n=new r.default({attrs:{id:"__SVG_SPRITE_NODE__"}})).mount():n=null;var i=n;e.default=i}));i(c);var h=a((function(e,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n,r=(n=t)&&n.__esModule?n:{default:n};function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function a(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function s(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach((function(e){l(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function l(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function u(t,e){if(null==t)return{};var o,n,r=function(t,e){if(null==t)return{};var o,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)o=i[n],e.indexOf(o)>=0||(r[o]=t[o]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)o=i[n],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(r[o]=t[o])}return r}var d={display:"block"};function c(t){var e=t.width,o=t.height,n=t.viewBox,a=t.id,l=t.className,c=t.style,h=t.fill,p=t.getRootRef,f=u(t,["width","height","viewBox","id","className","style","fill","getRootRef"]),y=Math.max(e,o);return r.default.createElement("div",i({},f,{ref:p,className:"Icon Icon--".concat(y," Icon--").concat(a," ").concat(l),style:s({},c,{width:e,height:o})}),r.default.createElement("svg",{viewBox:n,width:e,height:o,style:d},r.default.createElement("use",{xlinkHref:"#".concat(a),style:{fill:"currentColor",color:h}})))}c.defaultProps={className:"",style:{}};var h=c;o.default=h}));i(h);var p=i(a((function(e,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=l(t),r=l(s),i=l(c),a=l(h);function l(t){return t&&t.__esModule?t:{default:t}}var d="cancel_24";if(i.default){var p=new r.default({id:d,viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="cancel_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M18.3 5.7a.99.99 0 0 0-1.4 0L12 10.6 7.1 5.7a.99.99 0 0 0-1.4 1.4l4.9 4.9-4.9 4.9a.99.99 0 0 0 1.4 1.4l4.9-4.9 4.9 4.9a.99.99 0 0 0 1.4-1.4L13.4 12l4.9-4.9a.99.99 0 0 0 0-1.4z" fill="currentColor" /></g></symbol>'});i.default.add(p)}var f=function(t){return n.default.createElement(a.default,u({},t,{viewBox:"0 0 24 24",id:d,width:isNaN(t.width)?24:+t.width,height:isNaN(t.height)?24:+t.height}))};o.default=f}))),f=i(a((function(e,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=l(t),r=l(s),i=l(c),a=l(h);function l(t){return t&&t.__esModule?t:{default:t}}var d="dismiss_24";if(i.default){var p=new r.default({id:d,viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="dismiss_24"><g fill="currentColor" fill-rule="nonzero"><circle opacity=".12" cx="12" cy="12" r="12" /><path d="M12 10.727l3.464-3.463a.9.9 0 1 1 1.272 1.272L13.273 12l3.463 3.464a.9.9 0 1 1-1.272 1.272L12 13.273l-3.464 3.463a.9.9 0 1 1-1.272-1.272L10.727 12 7.264 8.536a.9.9 0 0 1 1.272-1.272L12 10.727z" /></g></symbol>'});i.default.add(p)}var f=function(t){return n.default.createElement(a.default,u({},t,{viewBox:"0 0 24 24",id:d,width:isNaN(t.width)?24:+t.width,height:isNaN(t.height)?24:+t.height}))};o.default=f})));class y extends t.Component{constructor(t){super(t),this.state={activePage:t.activePage,activeModal:null,modalHistory:[],modalParams:{},pageParams:{}},this.goPage=this.goPage.bind(this),this.showModal=this.showModal.bind(this),this.hideModal=this.hideModal.bind(this),this.navigatorObject={goPage:this.goPage,showModal:this.showModal,hideModal:window.history.back.bind(window.history)}}goPage(t,e={}){o.send("VKWebAppDisableSwipeBack",{}),this.setState({activePage:t,pageParams:e})}showModal(t,e={}){const{modalHistory:o}=this.state;this.setState({activeModal:t,modalHistory:-1!==o.indexOf(t)?o.splice(0,o.indexOf(t)+1):[...o,t],modalParams:e})}hideModal(){this.setState({activeModal:null,modalHistory:[]})}__buildModals(){const e=this.props.modals||[];if(0===e.length)return null;const{activeModal:o,modalParams:r}=this.state,{navigatorObject:i}=this,{platform:a}=this.props;return t.createElement(n.ModalRoot,{activeModal:o,children:t.Children.map(e,e=>t.cloneElement(e,{...e.props,onClose:window.history.back.bind(window.history),header:t.createElement(n.ModalPageHeader,{left:a===n.ANDROID&&t.createElement(n.PanelHeaderButton,{onClick:window.history.back.bind(window.history),children:t.createElement(p,null)}),right:a===n.IOS&&t.createElement(n.PanelHeaderButton,{onClick:window.history.back.bind(window.history),children:t.createElement(f,null)}),children:e.props.title||""}),navigator:{...i,params:e.props.id===o?r:{}}}))})}render(){const{activePage:e,activeModal:o,pageParams:r}=this.state,{showModal:i,hideModal:a,goPage:s}=this,{children:l,modal:u,disabledConfigProvider:d,webviewType:c,scheme:h}=this.props,p=this.__buildModals(u),f=t.createElement(n.Root,{activeView:e,modal:p},t.Children.map(l,e=>t.cloneElement(e,{id:e.props.id,showModal:i,hideModal:a,goPage:s,isModalOpen:null!==o,pageParams:r})));return d?f:t.createElement(n.ConfigProvider,{webviewType:c,isWebView:!0,scheme:h},f)}}y.propTypes={activePage:e.string.isRequired,scheme:e.string.isRequired},y.defaultProps={scheme:"bright_light"};var g=n.withPlatform(y);class v extends t.Component{constructor(t){super(t),this.state={activePanel:t.activePanel,homePanel:t.activePanel,history:[t.activePanel],popout:null,params:{},header:t.header},this.go=this.go.bind(this),this.goPage=this.props.goPage,this.popBack=this.popBack.bind(this),this.showModal=this.showModal.bind(this),this.hideModal=this.hideModal.bind(this),this.showPopout=this.showPopout.bind(this),this.showLoader=this.showLoader.bind(this),this.hideLoader=this.hideLoader.bind(this),this.showDialog=this.showDialog.bind(this),this.showAlert=this.showAlert.bind(this),this.headerVisible=this.headerVisible.bind(this),this.navigatorObject={go:this.go,goPage:this.goPage,goBack:window.history.back.bind(window.history),showModal:this.showModal,hideModal:()=>window.history.back,showPopout:this.showPopout,showLoader:this.showLoader,hideLoader:this.hideLoader,showDialog:this.showDialog,showAlert:this.showAlert,headerVisible:this.headerVisible}}go(t,e={}){const{activePanel:n,homePanel:r,history:i}=this.state;n===r&&o.send("VKWebAppEnableSwipeBack",{}),window.history.pushState({panel:t,modal:null},t),this.setState({activePanel:t,history:[...i,t],popout:null,params:e})}popBack(){const{history:t,popout:e,homePanel:n}=this.state,{isModalOpen:r}=this.props,{hideModal:i}=this;if(null!==e)return void this.setState({popout:null});if(r)return void i();if(1===t.length)return null;const a=t[t.length-2];a===n&&o.send("VKWebAppDisableSwipeBack",{}),this.setState({activePanel:a,history:t.slice(0,t.length-1),popout:null,activeModal:null,modalHistory:[],modalParams:{}})}showPopout(t){this.setState({popout:t})}showLoader(){this.showPopout(t.createElement(n.ScreenSpinner,null))}hideLoader(){this.showPopout(null)}showDialog({title:e,description:o,buttonText:r,action:i}){this.showPopout(t.createElement(n.Alert,{actionsLayout:"vertical",actions:[{title:r||"Удалить",action:i,style:"destructive"},{title:"Отмена",autoclose:!0,style:"cancel"}],onClose:()=>this.showPopout(null)},t.createElement("h2",null,e),t.createElement("p",null,o)))}showAlert({title:e,description:o}){this.showPopout(t.createElement(n.Alert,{actions:[{title:"Закрыть",autoclose:!0,style:"cancel"}],onClose:()=>this.showPopout(null)},t.createElement("h2",null,e),t.createElement("p",null,o)))}showModal(t,e={}){const{showModal:n}=this.props,{activePanel:r}=this.state;o.send("VKWebAppDisableSwipeBack",{}),window.history.pushState({panel:r,modal:t},r),n(t,e)}hideModal(){const{hideModal:t}=this.props,{activePanel:e,homePanel:n}=this.state;e!==n&&o.send("VKWebAppEnableSwipeBack",{}),t()}headerVisible(t){this.setState({header:t})}componentDidMount(){const{homePanel:t}=this.state;o.send("VKWebAppDisableSwipeBack",{}),window.addEventListener("popstate",this.popBack),window.history.replaceState({panel:t},t)}componentWillUnmount(){const{history:t}=this.state;window.removeEventListener("popstate",this.popBack);for(let e=0;e<t.length-1;e++)window.history.back()}render(){const{id:e,children:o,pageParams:r}=this.props,{activePanel:i,history:a,popout:s,params:l,header:u}=this.state,{navigatorObject:d}=this;return t.createElement(n.View,{id:e,activePanel:i,history:a,popout:s,header:u,onSwipeBack:window.history.back.bind(window.history)},t.Children.map(o,e=>t.cloneElement(e,{id:e.props.id,navigator:{...d,params:e.props.id===i?{...l,pageParams:r}:{}}})))}}v.propTypes={id:e.string.isRequired,activePanel:e.string.isRequired,children:e.any,header:e.bool},e.defaultProps={children:[]};class m extends t.Component{constructor(t){super(t),this.state={activeStory:t.activeStory},this.__buildBar=this.__buildBar.bind(this),this.goStory=this.goStory.bind(this)}goStory(t){this.setState({activeStory:t.currentTarget.dataset.story})}__buildBar(e){const{goStory:o}=this,{activeStory:r}=this.state;return t.createElement(n.Tabbar,null,t.Children.map(e,(e,i)=>t.createElement(n.TabbarItem,{key:i,onClick:o,selected:r===e.props.id,"data-story":e.props.id,text:e.props.title||"",children:e.props.icon||null,label:e.props.label||""})))}render(){const{id:e,children:o,showModal:r,hideModal:i,goPage:a,isModalOpen:s,pageParams:l}=this.props,{activeStory:u}=this.state,{__buildBar:d}=this;return t.createElement(n.Epic,{id:e,activeStory:u,tabbar:d(o)},t.Children.map(o,e=>t.cloneElement(e,{...e.props,goPage:a,showModal:r,hideModal:i,isModalOpen:s,pageParams:l})))}}return{Stack:g,Page:v,Tabbar:m}}));
